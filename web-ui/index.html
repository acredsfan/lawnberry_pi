<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/png" href="/assets/LawnBerryPi_logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#00FFD1" />
  <meta name="description" content="LawnBerryPi - Autonomous Lawn Mower Control Interface - 80's Retro Neon Theme" />
    <title>LawnBerryPi Control</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <style>
      body { margin:0; font-family:'Orbitron','Share Tech Mono',monospace; background:#0a0a0a; color:#00FFD1; }
      #root { height:100vh; width:100vw; }
      .loading { display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; gap:16px; font-size:18px; font-weight:700; letter-spacing:0.15em; text-transform:uppercase; }
      .scan-bar { width:240px; height:4px; background:linear-gradient(90deg,#00FFD1,#FF1493,#FFFF00,#00FFD1); background-size:300% 100%; animation: scan 2.2s linear infinite; box-shadow:0 0 15px rgba(0,255,209,0.6); }
      @keyframes scan { 0% { background-position:0 0; } 100% { background-position:300% 0; } }
    </style>
  </head>
  <body>
    <div id="root" data-hydration="pending">
      <div class="loading" id="initial-loader">
        <img src="/assets/LawnBerryPi_logo.png" alt="LawnBerryPi" width="120" height="120" style="filter:drop-shadow(0 0 12px #00FFD1);" />
        <div>Initializing LawnBerryPi Control</div>
        <div class="scan-bar"></div>
      </div>
    </div>
    <script>
      // Safety watchdog: remove loader if React fails to hydrate after 6s
      window.__LBP_START = performance.now();
      setTimeout(() => {
        const root = document.getElementById('root');
        if (root && root.getAttribute('data-hydration') === 'pending') {
          const loader = document.getElementById('initial-loader');
          if (loader) loader.innerHTML = '<div style="font:14px monospace; color:#FF1493;">Fallback load... (no React)</div>';
        }
      }, 6000);

      function showGlobalError(msg, stack) {
        if (document.getElementById('lbp-global-error')) return;
        const el = document.createElement('div');
        el.id = 'lbp-global-error';
        el.style.cssText='position:fixed;inset:0;background:#0a0a0ef;color:#FF1493;font:14px monospace;z-index:100000;padding:24px;overflow:auto';
        el.innerHTML = '<h2 style="margin-top:0">Fatal UI Error</h2><pre style="white-space:pre-wrap">'+(msg||'Unknown error')+'\n'+(stack||'')+'</pre><button style="background:#00FFD1;color:#000;padding:8px 16px;border:none;cursor:pointer" onclick="location.reload()">Reload</button>';
        document.body.appendChild(el);
      }
      window.addEventListener('error', e => { showGlobalError(e.message, e.error && e.error.stack) });
      window.addEventListener('unhandledrejection', e => { showGlobalError(e.reason && e.reason.message || 'Unhandled promise rejection', (e.reason && e.reason.stack) || '') });
    </script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
